{"version":3,"sources":["../../lib/patch-incorrect-lockfile.ts"],"names":["patchIncorrectLockfile","Log","dir","process","env","NEXT_IGNORE_INCORRECT_LOCKFILE","lockfilePath","findUp","cwd","content","promises","readFile","endingNewline","endsWith","lockfileParsed","JSON","parse","lockfileVersion","parseInt","expectedSwcPkgs","Object","keys","nextPkgJson","optionalDependencies","patchDependency","pkg","pkgData","dependencies","version","resolved","tarball","integrity","optional","patchPackage","packages","cpu","os","engines","supportedVersions","includes","shouldPatchDependencies","shouldPatchPackages","missingSwcPkgs","pkgPrefix","substring","length","push","warn","isCI","pkgsData","Promise","all","map","fetchPkgInfo","i","writeFile","stringify","err","error","console","registry","output","execSync","toString","trim","startsWith","_","res","fetch","ok","Error","status","data","json","versionData","versions","dist"],"mappings":"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"}